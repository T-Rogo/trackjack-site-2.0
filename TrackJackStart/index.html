<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Track Jack | Casino Map</title>

  <!-- Leaflet (FREE, no API key) -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <link rel="stylesheet" href="styles.css" />
  <link rel="manifest" href="manifest.webmanifest">
<meta name="theme-color" content="#0b0f17">
</head>

<body>
  <header class="topbar">
    <div class="brand">
      <div class="logo-dot"></div>
      <span>Track Jack</span>
    </div>

    <div class="top-actions">
      <button id="tabMap" class="btn btn-primary">Map</button>
      <button id="tabAnalytics" class="btn btn-ghost">Analytics</button>

      <div class="divider"></div>

      <button id="btnLocate" class="btn btn-ghost">üìç My Location</button>
      <button id="btnAddCasino" class="btn btn-ghost">Add Casino</button>
      <button id="btnAddVisit" class="btn btn-ghost">Add Visit</button>

      <div class="divider"></div>

      <button id="btnLogin" class="btn btn-ghost">Login</button>
      <button id="btnLogout" class="btn btn-ghost hidden">Logout</button>
    </div>
  </header>

  <!-- MAP VIEW -->
  <main id="viewMap" class="layout">
    <section id="map" class="map"></section>

    <aside class="panel">
      <div class="panel-head">
        <div class="panel-head-top">
          <div>
            <h2 id="panelTitle">Select a casino</h2>
            <p id="panelSubtitle">Click a pin to view totals and visits.</p>
          </div>

          <div class="panel-actions">
            <button id="btnEditCasino" class="btn btn-ghost small" disabled>Edit</button>
            <button id="btnDeleteCasino" class="btn btn-danger small" disabled>Delete</button>
          </div>
        </div>

        <div class="search-wrap">
          <input id="casinoSearch" class="search" placeholder="Search casinos..." />
          <div id="searchResults" class="search-results hidden"></div>

          <div class="grid2" style="margin-top:10px;">
            <select id="gameFilter" class="search">
              <option value="">All games</option>
            </select>
            <input id="dateFilter" class="search" type="month" />
          </div>

          <p class="hint tiny">
            Tip: Turn on ‚ÄúAdd Casino‚Äù then click the map to place it.
          </p>
        </div>
      </div>

      <div class="stats">
        <div class="stat">
          <div class="stat-label">Lifetime Net</div>
          <div id="statNet" class="stat-value">$0</div>
        </div>
        <div class="stat">
          <div class="stat-label">Visits</div>
          <div id="statVisits" class="stat-value">0</div>
        </div>
      </div>

      <div class="section">
        <div class="section-title-row">
          <div class="section-title">Visits</div>
          <div class="section-actions">
            <button id="btnAddVisitQuick" class="btn btn-ghost small">+ Visit</button>
          </div>
        </div>

        <div id="visitsList" class="list empty">No visits yet.</div>
      </div>

      <div class="footer-actions">
        <button id="btnExport" class="btn btn-ghost">Export JSON</button>
        <button id="btnImport" class="btn btn-ghost">Import JSON</button>
        <input id="fileImport" type="file" accept="application/json" class="hidden" />
        <button id="btnReset" class="btn btn-danger">Reset Data</button>
      </div>

      <p class="hint tiny" id="syncHint"></p>
    </aside>
  </main>

  <!-- ANALYTICS VIEW (simple KPIs now; easy to extend later) -->
  <main id="viewAnalytics" class="analytics hidden">
    <div class="analytics-grid">
      <div class="card">
        <div class="card-title">Overall</div>
        <div class="kpis">
          <div class="kpi">
            <div class="kpi-label">Total Net</div>
            <div id="kpiTotalNet" class="kpi-value">$0</div>
          </div>
          <div class="kpi">
            <div class="kpi-label">Total Visits</div>
            <div id="kpiTotalVisits" class="kpi-value">0</div>
          </div>
          <div class="kpi">
            <div class="kpi-label">Casinos Tracked</div>
            <div id="kpiTotalCasinos" class="kpi-value">0</div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-title">Top Casinos (by Net)</div>
        <div id="tableCasino" class="table"></div>
      </div>

      <div class="card">
        <div class="card-title">Top Games (by Net)</div>
        <div id="tableGame" class="table"></div>
      </div>

      <div class="card">
        <div class="card-title">Net by Month</div>
        <div id="tableMonth" class="table"></div>
      </div>
    </div>
  </main>

  <!-- iPhone-style Bottom Sheet -->
  <div id="sheetBackdrop" class="sheet-backdrop hidden"></div>
  <div id="sheet" class="sheet hidden" role="dialog" aria-modal="true">
    <div class="sheet-handle"></div>

    <div class="sheet-head">
      <div>
        <div id="sheetTitle" class="sheet-title">Title</div>
        <div id="sheetSub" class="sheet-sub">Subtitle</div>
      </div>
      <button id="sheetClose" class="btn btn-ghost small">‚úï</button>
    </div>

    <!-- Casino form -->
    <div id="sheetCasino" class="sheet-body hidden">
      <label class="field">
        <span>Name</span>
        <input id="casinoName" placeholder="e.g., Treasure Island" />
      </label>

      <label class="field">
        <span>Notes (optional)</span>
        <input id="casinoNotes" placeholder="City / trip / anything" />
      </label>

      <div class="grid2">
        <label class="field">
          <span>Latitude</span>
          <input id="casinoLat" placeholder="Tap map to fill" disabled />
        </label>
        <label class="field">
          <span>Longitude</span>
          <input id="casinoLng" placeholder="Tap map to fill" disabled />
        </label>
      </div>

      <div class="modal-actions">
        <button id="casinoCancel" class="btn btn-ghost">Cancel</button>
        <button id="casinoSave" class="btn btn-primary">Save Casino</button>
      </div>
    </div>

    <!-- Visit form -->
    <div id="sheetVisit" class="sheet-body hidden">
      <label class="field">
        <span>Casino</span>
        <select id="visitCasino"></select>
      </label>

      <div class="grid2">
        <label class="field">
          <span>Date</span>
          <input id="visitDate" type="date" />
        </label>

            <div class="field">
    <label for="gameSelect">Game</label>
    <select id="gameSelect" class="dark-select">
        <option value="" selected disabled>Select a game...</option>
    </select>
    </div>

      <label class="field">
        <span>Win/Loss (negative = loss)</span>
        <input id="visitAmount" type="number" step="1" placeholder="-200 or 350" />
      </label>

      <label class="field">
        <span>Notes (optional)</span>
        <textarea id="visitNotes" rows="3" placeholder="Anything you want to remember..."></textarea>
      </label>

      <div class="modal-actions">
        <button id="visitCancel" class="btn btn-ghost">Cancel</button>
        <button id="visitSave" class="btn btn-primary">Save Visit</button>
      </div>
    </div>

    <!-- Login form -->
    <div id="sheetLogin" class="sheet-body hidden">
      <p class="hint" style="margin-top:0">
        Login works when you add Firebase config in <code>app.js</code>. If you don‚Äôt, you can still use Guest mode (local storage).
      </p>

      <label class="field">
        <span>Email</span>
        <input id="loginEmail" type="email" placeholder="you@email.com" />
      </label>

      <label class="field">
        <span>Password</span>
        <input id="loginPassword" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />
      </label>

      <div class="modal-actions">
        <button id="loginCancel" class="btn btn-ghost">Cancel</button>
        <button id="loginGo" class="btn btn-primary">Login / Sign Up</button>
      </div>
    </div>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="app.js"></script>
</body>
</html>